[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "examples/index.html",
    "href": "examples/index.html",
    "title": "Exampels",
    "section": "",
    "text": "Exampels"
  },
  {
    "objectID": "examples/dose_response_curve.html",
    "href": "examples/dose_response_curve.html",
    "title": "Dose Response Curve Example",
    "section": "",
    "text": "from skcausal.datasets.synthetic2 import SyntheticDataset2\n\ndataset = SyntheticDataset2(n_features=6)\ndataset.prepare(n=1000, split_seed=42, preparation_seed=42)\n\nX, t, y = dataset.retrieve()\n\n\nX\n\n\nshape: (1_000, 6)\n\n\n\ncolumn_0\ncolumn_1\ncolumn_2\ncolumn_3\ncolumn_4\ncolumn_5\n\n\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n0.460742\n2.017809\n0.17723\n2.447803\n0.177521\n0.02248\n\n\n0.288838\n-0.333125\n1.689823\n1.342182\n0.632839\n0.378467\n\n\n0.661478\n-0.875629\n-0.647278\n0.494931\n-0.624121\n-2.117243\n\n\n-0.600697\n0.589961\n0.723263\n-0.768546\n-0.493024\n-2.225363\n\n\n0.740014\n0.636906\n0.340791\n-1.783611\n0.083621\n-0.556192\n\n\n…\n…\n…\n…\n…\n…\n\n\n-0.406134\n-1.028504\n-0.217144\n0.277344\n-0.494748\n0.553954\n\n\n0.623291\n0.347934\n-0.232851\n1.915435\n-0.906937\n0.004308\n\n\n-0.487116\n1.651992\n-0.104985\n0.149484\n1.203782\n0.585139\n\n\n-0.034656\n-1.426693\n-0.582354\n-0.279591\n-0.011291\n0.479733\n\n\n-0.262104\n-0.725858\n-1.215503\n-1.413517\n-2.339748\n-1.056346\n\n\n\n\n\n\n\nimport numpy as np\nimport polars as pl\n\ntreatment_grid = pl.DataFrame(np.linspace(0, 1, 100), schema=t.schema)\ntrue_adrf = dataset.get_adrf(X, t)\n\n\nimport matplotlib.pyplot as plt\n\nfig, ax = plt.subplots()\nplt.scatter(t, y, alpha=0.3)\n# Argsort true_adrf for plotting\nsorted_indices = np.argsort(t.to_numpy().flatten())\nplt.plot(\n    t[sorted_indices],\n    true_adrf[sorted_indices],\n    color=\"red\",\n    linewidth=2,\n)\nfig.show()\n\n\n\n\n\n\n\n\n\nfrom skcausal.causal_estimators.ignore_covariates import DirectNoCovariates\n\nfrom sklearn.ensemble import RandomForestRegressor\n\nestimator = DirectNoCovariates(outcome_regressor=RandomForestRegressor(min_samples_leaf=30))\nestimator.fit(X, t=t, y=y)\n\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/base.py:1365: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().\n  return fit_method(estimator, *args, **kwargs)\n\n\nDirectNoCovariates(outcome_regressor=RandomForestRegressor(min_samples_leaf=30))Please rerun this cell to show the HTML repr or trust the notebook.DirectNoCovariatesDirectNoCovariates(outcome_regressor=RandomForestRegressor(min_samples_leaf=30))RandomForestRegressorRandomForestRegressor(min_samples_leaf=30)\n\n\n\ny_pred = estimator.predict_adrf(X, t)\n\n\nfig, ax = plt.subplots()\nplt.scatter(t, y, alpha=0.3)\n# Argsort true_adrf for plotting\nsorted_indices = np.argsort(t.to_numpy().flatten())\nplt.plot(\n    t[sorted_indices],\n    true_adrf[sorted_indices],\n    color=\"red\",\n    linewidth=2,\n)\nplt.plot(\n    t[sorted_indices],\n    y_pred[sorted_indices],\n    color=\"green\",\n    linewidth=2,\n)\nfig.show()\n\n\n\n\n\n\n\n\n\nfrom skcausal.causal_estimators.continuous.doubly_robust import (\n    DoublyRobustPseudoOutcome,\n)\nfrom skcausal.weight_estimators.multiplicative_boosting import (\n    DiscriminativeWeightBoosting,\n)\nfrom sklearn.ensemble import RandomForestClassifier\n\ndr = DoublyRobustPseudoOutcome(\n    treatment_regressor=DiscriminativeWeightBoosting(\n        classifier=RandomForestClassifier(min_samples_leaf=30),\n        n_boosting_iter=5,\n        method=\"balanced\",\n        complexity_factor=5,\n    ),\n    outcome_regressor=RandomForestRegressor(min_samples_leaf=30),\n    pseudo_outcome_regressor=RandomForestRegressor(min_samples_leaf=30),\n)\ndr.fit(X, t=t, y=y)\n\nDoublyRobustPseudoOutcome(outcome_regressor=RandomForestRegressor(min_samples_leaf=30),\n                          pseudo_outcome_regressor=RandomForestRegressor(min_samples_leaf=30),\n                          treatment_regressor=DiscriminativeWeightBoosting(classifier=RandomForestClassifier(min_samples_leaf=30),\n                                                                           complexity_factor=5,\n                                                                           method='balanced',\n                                                                           n_boosting_iter=5))Please rerun this cell to show the HTML repr or trust the notebook.DoublyRobustPseudoOutcomeDoublyRobustPseudoOutcome(outcome_regressor=RandomForestRegressor(min_samples_leaf=30),\n                          pseudo_outcome_regressor=RandomForestRegressor(min_samples_leaf=30),\n                          treatment_regressor=DiscriminativeWeightBoosting(classifier=RandomForestClassifier(min_samples_leaf=30),\n                                                                           complexity_factor=5,\n                                                                           method='balanced',\n                                                                           n_boosting_iter=5))RandomForestRegressorRandomForestRegressor(min_samples_leaf=30)RandomForestRegressorRandomForestRegressor(min_samples_leaf=30)RandomForestClassifierRandomForestClassifier(min_samples_leaf=30)\n\n\n\ny_dr_pred = dr.predict_adrf(X, t)\n\n\nfrom skcausal.causal_estimators.gps import GPS\n\ngps = GPS(\n    treatment_regressor=DiscriminativeWeightBoosting(\n        classifier=RandomForestClassifier(min_samples_leaf=30),\n        n_boosting_iter=5,\n        method=\"uniform\",\n        complexity_factor=5,\n    ),\n    outcome_regressor=RandomForestRegressor(min_samples_leaf=30),\n    include_in_outcome_dataset=\"both\",\n    predict_subsample_size=100,\n)\n\n\ngps.fit(X, t=t, y=y)\ny_gps_pred = gps.predict_adrf(X, t)\n\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/base.py:1365: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().\n  return fit_method(estimator, *args, **kwargs)\n\n\n\nfrom skcausal.causal_estimators.continuous import PropensityPseudoOutcomeContinuous\nfrom sklearn.neural_network import MLPClassifier\n\npw = PropensityPseudoOutcomeContinuous(\n    treatment_regressor=DiscriminativeWeightBoosting(\n        classifier=MLPClassifier(hidden_layer_sizes=(25, 25), max_iter=500),\n        n_boosting_iter=10,\n        method=\"uniform\",\n        complexity_factor=1.1,\n    ),\n    pseudo_outcome_regressor=RandomForestRegressor(min_samples_leaf=30),\n)\n\n\npw.fit(X, t=t, y=y)\ny_pw_pred = pw.predict_adrf(X, t)\n\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/sklearn/neural_network/_multilayer_perceptron.py:781: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn't converged yet.\n  warnings.warn(\n\n\n\nfig, ax = plt.subplots()\nplt.scatter(t, y, alpha=0.3)\n# Argsort true_adrf for plotting\nsorted_indices = np.argsort(t.to_numpy().flatten())\nplt.plot(\n    t[sorted_indices],\n    true_adrf[sorted_indices],\n    color=\"red\",\n    linewidth=2,\n)\nplt.plot(\n    t[sorted_indices],\n    y_pred[sorted_indices],\n    color=\"green\",\n    linewidth=2,\n    label=\"DirectNoCovariates\",\n)\nplt.plot(\n    t[sorted_indices],\n    y_dr_pred[sorted_indices],\n    color=\"blue\",\n    linewidth=2,\n    label=\"DoublyRobustPseudoOutcome\",\n)\nplt.plot(\n    t[sorted_indices],\n    y_gps_pred[sorted_indices],\n    color=\"orange\",\n    linewidth=2,\n    label=\"GPS\",\n)\nplt.plot(\n    t[sorted_indices],\n    y_pw_pred[sorted_indices],\n    color=\"purple\",\n    linewidth=2,\n    label=\"PropensityPseudoOutcomeContinuous\",\n)\nplt.legend()\nfig.show()"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "docs",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites."
  }
]